<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="../bootstrap.4.6.2.css">
		<style>
            /* body::-webkit-scrollbar {
                display: none;
            } */
            body{
                overflow: hidden;
            }
			canvas{
                border: 1px solid;
                cursor: none;
            }
		</style>
	</head>
	<body>
		<canvas id="canvas"></canvas>
	</body>
	<script>
		let c = document.getElementById('canvas');
        ctx = c.getContext('2d');

        let w = window.innerWidth - 3;
        let h = window.innerHeight - 3;
        c.width = w;
        c.height = h;
        ctx.lineWidth = '5';
        let pellate = [
            '#049DD9',
            '#05C7F2',
            '#05DBF2',
            '#F23005',
            '#0D0D0D'
        ];

        function Circle(x, y, vx, vy, r, rs, color){
            this.x = x;
            this.y = y;
            this.vx = vx;
            this.vy = vy;
            this.r = r;
            this.rs = rs;
            this.color = color;

            this.draw = function(){
                ctx.beginPath();
                ctx.strokeStyle = color;
                let grd = ctx.createRadialGradient(this.x,this.y,this.r/10,this.x,this.y,this.r);
                grd.addColorStop(0,'#ffffff00');
                grd.addColorStop(1,color);
                // grd.addColorStop(2,'#ffffff00');
                ctx.fillStyle = grd;
                ctx.arc(this.x, this.y, this.r, 0, 2*Math.PI);
                // ctx.stroke();
                ctx.fill();
            }

            this.update = function(){
                this.draw();
                // for(z = 0; z < 50; z++){
                //     if(circleArr[z] !== this){
                //         if(this.x + this.r > circleArr[z].x - circleArr[z].r && this.x - this.r < circleArr[z].x + circleArr[z].r){
                //             if(this.y + this.r > circleArr[z].y - circleArr[z].r && this.y - this.r < circleArr[z].y + circleArr[z].r){
                //                 this.vx = -this.vx;
                //                 this.vy = -this.vy;
                //             }
                //         }
                //     }
                // }
                if(this.x + this.r > w || this.x - this.r < 0){
                    this.vx = -this.vx;
                }

                if(this.y + this.r > h || this.y - this.r < 0){
                    this.vy = -this.vy;
                }
                if(this.r > 50 || this.r <= 0){
                    this.rs = -this.rs;
                }
                this.r += this.rs;
                this.x += this.vx;
                this.y += this.vy;
                
                if(this.r < 0){
                    this.r = 0;
                }
            }
        }

        function CircleTemp(x, y, vx, vy, r, rs, color, maxr){
            this.x = x;
            this.y = y;
            this.vx = vx;
            this.vy = vy;
            this.r = r;
            this.rs = rs;
            this.color = color;
            this.maxr = maxr;

            this.draw = function(){
                ctx.beginPath();
                ctx.strokeStyle = color;
                let grd = ctx.createRadialGradient(this.x,this.y,this.r/10,this.x,this.y,this.r);
                grd.addColorStop(0,'#ffffff00');
                grd.addColorStop(1,color);
                ctx.fillStyle = color;
                ctx.arc(this.x, this.y, this.r, 0, 2*Math.PI);
                // ctx.stroke();
                ctx.fill();
            }

            this.update = function(){
                this.draw();
                if(this.x + this.r > w || this.x - this.r < 0){
                    this.vx = -this.vx;
                }
                if(this.y + this.r > h || this.y - this.r < 0){
                    this.vy = -this.vy;
                }
            
                if(this.r > maxr || this.r <= 0){
                    this.rs = -this.rs;
                }
                this.r += this.rs;
                this.x += this.vx;
                this.y += this.vy;
                
                if(this.r < 0){
                    this.r = 0;
                    this.rs = 0;
                }
            }
        }

        let circleArr = [];
        for(i = 0; i < 50; i++){
            let r = Math.random() * 50;
            let rs = Math.random() / 10;
            let x = Math.random() * (w - r * 2) + r;
            let y = Math.random() * (h - r * 2) + r;
            let vx = (Math.random() - 0.5) ;
            let vy = (Math.random() - 0.5) ;
            // let color = 'rgba(' + Math.random() * 225 + ',' + Math.random() * 225 + ','+Math.random() * 225 + ','+Math.random() * 100/100 + ')';
            let color = pellate[parseInt(Math.random() * pellate.length)];
            circleArr[i] = new Circle(x, y, vx, vy, r, rs, color);
        }

        let posX;
        let posY;
        let maxr = 5;
        function mouseAdd(){
            // let maxr = 5;
            let r = Math.random() * 1;
            let rs = Math.random() + 5;
            let x = posX;
            let y = posY;
            let vx = (Math.random() - 0.5) * 5;
            let vy = (Math.random() - 0.5) * 5;
            // let color = 'rgba(' + Math.random() * 225 + ',' + Math.random() * 225 + ','+Math.random() * 225 + ','+Math.random() * 100/100 + ')';
            let color = pellate[parseInt(Math.random() * pellate.length)];
            circleArr.push(new CircleTemp(x, y, vx, vy, r, rs, color, maxr));
        }

        c.addEventListener('click', () => setInterval(()=>{if(maxr<100){maxr+=1}},10))

        // c.addEventListener('mousemove', mouseAdd)
        function mousePos(){
            posX = event.x;
            posY = event.y;
        }

        let interval;
        c.addEventListener('mouseover',() => {
            c.addEventListener('mousemove', mousePos)
            interval = setInterval(function(){
                mouseAdd()
            }, 1);
        })
        // c.addEventListener('mousemove', mousePos)
        c.addEventListener('mouseout',() => {clearInterval(interval)});

        function animate(){
            requestAnimationFrame(animate);
            ctx.clearRect(0, 0, w, h);

            for(i = 0; i < circleArr.length; i++){
                circleArr[i].update();
            }
        }
        animate();
	</script>
</html>